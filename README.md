# è‡ªåŠ©é»é¤ç³»çµ± (Self-Service Ordering System)

ä¸€å€‹å®Œæ•´çš„è‡ªåŠ©é»é¤ç³»çµ±ï¼Œæ”¯æŒä¸­è‹±æ–‡é›™èªç•Œé¢ï¼ŒåŒ…å«å‰ç«¯é»é¤ç•Œé¢ã€å¾Œç«¯ API æœå‹™ã€è¨‚å–®ç®¡ç†å’Œå°ç¥¨æ‰“å°åŠŸèƒ½ã€‚

## ğŸ“‹ ç›®éŒ„

- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [æŠ€è¡“æ£§](#æŠ€è¡“æ£§)
- [é …ç›®çµæ§‹](#é …ç›®çµæ§‹)
- [å¿«é€Ÿé–‹å§‹](#å¿«é€Ÿé–‹å§‹)
- [é…ç½®èªªæ˜](#é…ç½®èªªæ˜)
- [API æ–‡æª”](#api-æ–‡æª”)
- [æ§‹å»ºå’Œéƒ¨ç½²](#æ§‹å»ºå’Œéƒ¨ç½²)
- [å¸¸è¦‹å•é¡Œ](#å¸¸è¦‹å•é¡Œ)

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### å‰ç«¯åŠŸèƒ½
- ğŸ½ï¸ **èœå“å±•ç¤º**ï¼šç¶²æ ¼å¸ƒå±€å±•ç¤ºæ‰€æœ‰èœå“ï¼Œæ”¯æŒæ¯è¡Œé¡¯ç¤ºå…©å€‹èœå“
- ğŸ›’ **è³¼ç‰©è»Šç®¡ç†**ï¼šå¯¦æ™‚æ›´æ–°è³¼ç‰©è»Šï¼Œæ”¯æŒå¢æ¸›æ•¸é‡ã€åˆªé™¤å•†å“
- ğŸ’³ **å¤šç¨®ä»˜æ¬¾æ–¹å¼**ï¼šæ”¯æŒå¾®ä¿¡ã€æ”¯ä»˜å¯¶ã€Visaã€Mastercardã€å…«é”é€šã€ç¾é‡‘ç­‰å¤šç¨®ä»˜æ¬¾æ–¹å¼
- ğŸŒ **ä¸­è‹±æ–‡åˆ‡æ›**ï¼šä¸€éµåˆ‡æ›ç•Œé¢èªè¨€ï¼Œæ‰€æœ‰å…§å®¹å¯¦æ™‚æ›´æ–°
- ğŸ“± **éŸ¿æ‡‰å¼è¨­è¨ˆ**ï¼šé©é…ä¸åŒå±å¹•å°ºå¯¸ï¼Œè‡ªå‹•èª¿æ•´å¸ƒå±€
- ğŸ’¾ **æœ¬åœ°å­˜å„²**ï¼šè³¼ç‰©è»Šæ•¸æ“šè‡ªå‹•ä¿å­˜ï¼Œåˆ·æ–°ä¸ä¸Ÿå¤±

### å¾Œç«¯åŠŸèƒ½
- ğŸ“ **è¨‚å–®ç®¡ç†**ï¼šå‰µå»ºã€æŸ¥è©¢ã€ç®¡ç†è¨‚å–®
- ğŸ–¨ï¸ **å°ç¥¨æ‰“å°**ï¼šè‡ªå‹•æ‰“å°è¨‚å–®å°ç¥¨ï¼Œæ”¯æŒå¤šç¨®æ‰“å°æ©Ÿ
- ğŸ± **èœå“ç®¡ç†**ï¼šèœå“ä¿¡æ¯ç®¡ç†ï¼Œæ”¯æŒä¸­è‹±æ–‡åç¨±å’Œæè¿°
- âš™ï¸ **ç³»çµ±è¨­ç½®**ï¼šåº—é‹ªåç¨±ã€èªè¨€è¨­ç½®ç­‰é…ç½®ç®¡ç†
- ğŸ’° **ä»˜æ¬¾æ–¹å¼ç®¡ç†**ï¼šå‹•æ…‹é…ç½®æ”¯æŒçš„ä»˜æ¬¾æ–¹å¼

## ğŸ› ï¸ æŠ€è¡“æ£§

### å‰ç«¯
- **æ¡†æ¶**ï¼šVue 3.5.22
- **æ§‹å»ºå·¥å…·**ï¼šVite 6.4.1
- **è·¯ç”±**ï¼šVue Router 4.6.3
- **UI çµ„ä»¶**ï¼šElement Plus 2.11.7
- **HTTP å®¢æˆ¶ç«¯**ï¼šAxios 1.13.1
- **ç‹€æ…‹ç®¡ç†**ï¼šPinia 3.0.3

### å¾Œç«¯
- **é‹è¡Œæ™‚**ï¼šNode.js >= 18.20.8
- **æ¡†æ¶**ï¼šExpress 5.1.0
- **æ•¸æ“šåº«**ï¼šSQLite 3 (Sequelize ORM)
- **æ‰“å°æœå‹™**ï¼šFFI-NAPI (Windows DLL èª¿ç”¨)
- **ç·¨ç¢¼è™•ç†**ï¼šiconv-lite

## ğŸ“ é …ç›®çµæ§‹

```
orderFood-system/
â”œâ”€â”€ orderFood-client/          # å‰ç«¯é …ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/              # API æ¥å£å°è£
â”‚   â”‚   â”œâ”€â”€ assets/           # éœæ…‹è³‡æºï¼ˆåœ–ç‰‡ã€åœ–æ¨™ï¼‰
â”‚   â”‚   â”œâ”€â”€ router/           # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ views/            # é é¢çµ„ä»¶
â”‚   â”‚       â”œâ”€â”€ OrderView.vue              # é»é¤é é¢
â”‚   â”‚       â”œâ”€â”€ PaymentMethodView.vue      # ä»˜æ¬¾æ–¹å¼é¸æ“‡é é¢
â”‚   â”‚       â””â”€â”€ PaymentInstructionView.vue # ä»˜æ¬¾æŒ‡ç¤ºé é¢
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.js
â”‚
â”œâ”€â”€ orderFood-server/          # å¾Œç«¯é …ç›®
â”‚   â”œâ”€â”€ controllers/          # æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ orderFoodController.js
â”‚   â”œâ”€â”€ models/               # æ•¸æ“šæ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ Meal.js           # èœå“æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ Order.js          # è¨‚å–®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ OrderItem.js      # è¨‚å–®é …æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ PaymentMethod.js  # ä»˜æ¬¾æ–¹å¼æ¨¡å‹
â”‚   â”‚   â””â”€â”€ Settings.js       # è¨­ç½®æ¨¡å‹
â”‚   â”œâ”€â”€ routes/               # è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ index.js
â”‚   â”‚   â””â”€â”€ orderFood.js
â”‚   â”œâ”€â”€ services/             # æ¥­å‹™é‚è¼¯
â”‚   â”‚   â”œâ”€â”€ orderFoodService.js  # è¨‚å–®æœå‹™
â”‚   â”‚   â””â”€â”€ printerService.js    # æ‰“å°æœå‹™
â”‚   â”œâ”€â”€ scripts/              # åˆå§‹åŒ–è…³æœ¬
â”‚   â”‚   â”œâ”€â”€ initMeals.js
â”‚   â”‚   â”œâ”€â”€ initPaymentMethods.js
â”‚   â”‚   â”œâ”€â”€ initSettings.js
â”‚   â”‚   â””â”€â”€ migrateDatabase.js
â”‚   â”œâ”€â”€ utils/                # å·¥å…·å‡½æ•¸
â”‚   â”‚   â”œâ”€â”€ logger.js
â”‚   â”‚   â”œâ”€â”€ printerLogger.js
â”‚   â”‚   â”œâ”€â”€ getDatabasePath.js
â”‚   â”‚   â””â”€â”€ loadPrinterModules.js
â”‚   â”œâ”€â”€ printer_sdk/          # æ‰“å°æ©Ÿ SDK
â”‚   â”œâ”€â”€ app.js                # Express æ‡‰ç”¨
â”‚   â”œâ”€â”€ index.js              # æœå‹™å™¨å…¥å£
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ build-scripts/            # æ§‹å»ºè…³æœ¬
â”‚   â”œâ”€â”€ build.js              # æ‰“åŒ…è…³æœ¬
â”‚   â”œâ”€â”€ install-prebuilt-modules.js
â”‚   â””â”€â”€ clean-dist.bat
â”‚
â””â”€â”€ package.json              # æ ¹ç›®éŒ„é…ç½®
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ç’°å¢ƒè¦æ±‚

- Node.js >= 18.20.8
- npm >= 9.0.0
- Windows 10/11 (æ‰“å°åŠŸèƒ½éœ€è¦ Windows)

### å®‰è£æ­¥é©Ÿ

1. **å…‹éš†é …ç›®**
```bash
git clone <repository-url>
cd orderFood-system
```

2. **å®‰è£ä¾è³´**

```powershell
# å®‰è£æ ¹ç›®éŒ„ä¾è³´
npm install

# å®‰è£å¾Œç«¯ä¾è³´
cd orderFood-server
npm install

# å®‰è£å‰ç«¯ä¾è³´
cd ../orderFood-client
npm install
```

3. **åˆå§‹åŒ–æ•¸æ“šåº«**

```powershell
cd orderFood-server
npm run migrate
npm run init-meals
npm run init-payment-methods
npm run init-settings
```

4. **å•Ÿå‹•é–‹ç™¼æœå‹™å™¨**

```powershell
# åœ¨é …ç›®æ ¹ç›®éŒ„åŸ·è¡Œ
npm run dev

# æˆ–è€…åˆ†åˆ¥å•Ÿå‹•
npm run dev:server  # å•Ÿå‹•å¾Œç«¯ï¼ˆç«¯å£ 3002ï¼‰
npm run dev:client  # å•Ÿå‹•å‰ç«¯ï¼ˆç«¯å£ 5173ï¼‰
```

5. **è¨ªå•æ‡‰ç”¨**

- å‰ç«¯ç•Œé¢ï¼šhttp://localhost:5173
- å¾Œç«¯ APIï¼šhttp://localhost:3002

## âš™ï¸ é…ç½®èªªæ˜

### å¾Œç«¯é…ç½®

#### ç«¯å£é…ç½®

é»˜èªç«¯å£ç‚º `3002`ï¼Œå¯é€šéç’°å¢ƒè®Šé‡ä¿®æ”¹ï¼š

```powershell
$env:PORT=8080
npm start
```

#### æ‰“å°æ©Ÿé…ç½®

ç·¨è¼¯ `orderFood-server/printer.config.json`ï¼š

```json
{
  "port": "COM3",
  "printerName": "ç†±æ•æ‰“å°æ©Ÿ",
  "encoding": "GB2312",
  "width": 80
}
```

#### æ•¸æ“šåº«é…ç½®

æ•¸æ“šåº«æ–‡ä»¶ä½ç½®ï¼š`orderFood-server/database.sqlite`

### å‰ç«¯é…ç½®

#### API åœ°å€é…ç½®

ç·¨è¼¯ `orderFood-client/src/api/index.js`ï¼š

```javascript
const API_BASE_URL = 'http://localhost:3002';
```

## ğŸ“¡ API æ–‡æª”

### èœå“ç›¸é—œ

#### ç²å–èœå“åˆ—è¡¨
```
GET /api/orderfood/meals
```

éŸ¿æ‡‰ç¤ºä¾‹ï¼š
```json
[
  {
    "id": 1,
    "name": "ä¸€èœå¥—é¤",
    "nameEn": "One Dish Set",
    "desc": "ç²¾é¸ä¸€èœ",
    "descEn": "Selected one dish",
    "price": 15
  }
]
```

### è¨‚å–®ç›¸é—œ

#### å‰µå»ºè¨‚å–®
```
POST /api/orderfood/orders
```

è«‹æ±‚é«”ï¼š
```json
{
  "items": [
    {
      "id": 1,
      "name": "ä¸€èœå¥—é¤",
      "quantity": 2,
      "price": 15
    }
  ],
  "totalAmount": 30,
  "orderType": 0,
  "paymentMethod": {
    "id": 1,
    "code": "cash",
    "name": "ç¾é‡‘"
  }
}
```

éŸ¿æ‡‰ï¼š
```json
{
  "success": true,
  "message": "è¨‚å–®å‰µå»ºæˆåŠŸ",
  "data": {
    "id": 1,
    "orderNumber": "OF20240101001",
    "totalAmount": 30
  }
}
```

### ä»˜æ¬¾æ–¹å¼ç›¸é—œ

#### ç²å–ä»˜æ¬¾æ–¹å¼åˆ—è¡¨
```
GET /api/orderfood/payment-methods
```

### è¨­ç½®ç›¸é—œ

#### ç²å–è¨­ç½®
```
GET /api/orderfood/settings?key=store_name_zh
```

#### æ›´æ–°è¨­ç½®
```
PUT /api/orderfood/settings
```

è«‹æ±‚é«”ï¼š
```json
{
  "key": "store_name_zh",
  "value": "æˆ‘çš„é¤å»³"
}
```

## ğŸ—ï¸ æ§‹å»ºå’Œéƒ¨ç½²

### é–‹ç™¼æ§‹å»º

```powershell
# æ§‹å»ºå‰ç«¯
cd orderFood-client
npm run build

# æ§‹å»ºå¾Œç«¯ï¼ˆæ‰“åŒ…æˆå¯åŸ·è¡Œæ–‡ä»¶ï¼‰
cd ../orderFood-server
npm run build
```

### ç”Ÿç”¢æ§‹å»º

#### Windows å¯åŸ·è¡Œæ–‡ä»¶

```powershell
npm run build:win
```

ç”Ÿæˆçš„å¯åŸ·è¡Œæ–‡ä»¶ä½æ–¼ `dist/orderFood-system.exe`

#### æ‰“åŒ…é…ç½®

ç·¨è¼¯ `orderFood-server/package.json` ä¸­çš„ `pkg` é…ç½®ä¾†èª¿æ•´æ‰“åŒ…é¸é …ã€‚

### éƒ¨ç½²æ­¥é©Ÿ

1. **æ§‹å»ºå‰ç«¯**
```powershell
cd orderFood-client
npm run build
```

2. **è¤‡è£½å‰ç«¯æ–‡ä»¶åˆ°å¾Œç«¯**
```powershell
# å°‡ dist ç›®éŒ„å…§å®¹è¤‡è£½åˆ° orderFood-server/public
```

3. **æ‰“åŒ…å¾Œç«¯**
```powershell
cd orderFood-server
npm run build
```

4. **é‹è¡Œå¯åŸ·è¡Œæ–‡ä»¶**
```powershell
.\dist\orderFood-system.exe
```

## ğŸ”§ å¸¸è¦‹å•é¡Œ

### 1. æ‰“å°æ©Ÿç„¡æ³•é€£æ¥

**å•é¡Œ**ï¼šæ‰“å°æ©Ÿç„¡æ³•æ­£å¸¸å·¥ä½œ

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
- æª¢æŸ¥ `printer.config.json` ä¸­çš„ç«¯å£é…ç½®
- ç¢ºèªæ‰“å°æ©Ÿé©…å‹•å·²æ­£ç¢ºå®‰è£
- æª¢æŸ¥ `printer_sdk` ç›®éŒ„ä¸­çš„ DLL æ–‡ä»¶æ˜¯å¦å­˜åœ¨

### 2. æ•¸æ“šåº«åˆå§‹åŒ–å¤±æ•—

**å•é¡Œ**ï¼šæ•¸æ“šåº«è¡¨å‰µå»ºå¤±æ•—

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
```powershell
cd orderFood-server
npm run migrate
```

### 3. å‰ç«¯ç„¡æ³•é€£æ¥å¾Œç«¯

**å•é¡Œ**ï¼šå‰ç«¯è«‹æ±‚å¾Œç«¯ API å¤±æ•—

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
- æª¢æŸ¥å¾Œç«¯æœå‹™æ˜¯å¦æ­£å¸¸é‹è¡Œ
- ç¢ºèª `orderFood-client/src/api/index.js` ä¸­çš„ API åœ°å€æ­£ç¢º
- æª¢æŸ¥ CORS é…ç½®

### 4. èªè¨€åˆ‡æ›ä¸ç”Ÿæ•ˆ

**å•é¡Œ**ï¼šåˆ‡æ›èªè¨€å¾Œå…§å®¹æ²’æœ‰æ›´æ–°

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
- ç¢ºèªæ•¸æ“šåº«ä¸­èœå“åŒ…å«ä¸­è‹±æ–‡åç¨±
- æª¢æŸ¥ç€è¦½å™¨ localStorage æ˜¯å¦æ­£å¸¸
- æ¸…é™¤ç€è¦½å™¨ç·©å­˜å¾Œé‡è©¦

### 5. è³¼ç‰©è»Šæ•¸æ“šä¸Ÿå¤±

**å•é¡Œ**ï¼šåˆ·æ–°é é¢å¾Œè³¼ç‰©è»Šæ¸…ç©º

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
- æª¢æŸ¥ç€è¦½å™¨æ˜¯å¦ç¦ç”¨äº† localStorage
- ç¢ºèªä»£ç¢¼ä¸­ `saveCartToStorage()` å‡½æ•¸æ­£å¸¸åŸ·è¡Œ

## ğŸ“ é–‹ç™¼æŒ‡å—

### æ·»åŠ æ–°èœå“

1. ç·¨è¼¯ `orderFood-server/scripts/initMeals.js`
2. æ·»åŠ èœå“æ•¸æ“š
3. é‹è¡Œåˆå§‹åŒ–è…³æœ¬ï¼š
```powershell
npm run init-meals
```

### æ·»åŠ æ–°ä»˜æ¬¾æ–¹å¼

1. ç·¨è¼¯ `orderFood-server/scripts/initPaymentMethods.js`
2. æ·»åŠ ä»˜æ¬¾æ–¹å¼æ•¸æ“š
3. é‹è¡Œåˆå§‹åŒ–è…³æœ¬ï¼š
```powershell
npm run init-payment-methods
```

### è‡ªå®šç¾©æ‰“å°æ ¼å¼

ç·¨è¼¯ `orderFood-server/services/printerService.js` ä¸­çš„æ‰“å°æ¨¡æ¿ã€‚

## ğŸ“„ è¨±å¯è­‰

ISC

## ğŸ‘¥ è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“ æ”¯æŒ

å¦‚æœ‰å•é¡Œï¼Œè«‹æŸ¥çœ‹é …ç›®ä¸­çš„ `README/` ç›®éŒ„ä¸‹çš„è©³ç´°æ–‡æª”ï¼Œæˆ–æäº¤ Issueã€‚

---

**ç‰ˆæœ¬**ï¼š1.0.0  
**æœ€å¾Œæ›´æ–°**ï¼š2024
